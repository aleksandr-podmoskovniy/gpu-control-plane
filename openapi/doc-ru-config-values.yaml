type: object
description: |
  Конфигурация модуля GPU Control Plane повторяет подход Deckhouse: только ключевые опции,
  необходимые для запуска и эксплуатации. Любые внутренние параметры подбираются автоматически.
properties:
  highAvailability:
    description: |
      Управление высокодоступным режимом контроллеров и вебхуков.

      * `true` — принудительно включить HA независимо от топологии control plane;
      * `false` — закрепить работу в одинарном режиме;
      * не задан — использовать автодетекцию Deckhouse.
  managedNodes:
    description: |
      Политика управляемости узлов. Определяет метку, включающую обслуживание, и дефолтное поведение.
    properties:
      labelKey:
        description: |
          Ключ метки, проверяемой на узлах. Если значение метки не равно строке `false`,
          узел считается управляемым. По умолчанию используется `gpu.deckhouse.io/enabled`.
      enabledByDefault:
        description: |
          Флаг «узлы управляются по умолчанию». Позволяет массово отключить модуль, выставив
          `labelKey=false` только на нужных нодах. Значение по умолчанию — `true`.
  deviceApproval:
    description: |
      Правила подтверждения (approval) новых GPU-устройств. Позволяет выбрать ручной режим,
      включить полностью автоматический или описать селектор.
    properties:
      mode:
        description: |
          Режим подтверждения:
            * `Manual` — устройства остаются в ожидании, администратор решает вручную;
            * `Automatic` — подтверждаются сразу;
            * `Selector` — подтверждаются автоматически только устройства, подходящие под селектор.
          Значение по умолчанию — `Manual`.
      selector:
        description: |
          Kubernetes LabelSelector, применяемый к метаданным устройства. Используется только
          в режиме `Selector`.
        properties:
          matchLabels:
            description: |
              Список обязательных меток формата `ключ=значение`.
          matchExpressions:
            description: |
              Набор выражений (`In`, `NotIn`, `Exists`, `DoesNotExist`) как в стандартном LabelSelector.
            items:
              description: |
                Отдельное выражение селектора: ключ, оператор и набор значений (для `In`/`NotIn`).
  scheduling:
    description: |
      Значения по умолчанию для планировщика GPU-подов. Наследуются GPUPool, если не переопределены.
    properties:
      defaultStrategy:
        description: |
          Стратегия распределения нагрузки: `Spread` распределяет workload по зонам,
          `BinPack` уплотняет размещение на минимальном числе узлов. Значение по умолчанию —
          `Spread`.
      topologyKey:
        description: |
          Ключ топологии Kubernetes, используемый при стратегии `Spread`. По умолчанию —
          `topology.kubernetes.io/zone`.
  inventory:
    description: |
      Настройки фонового опроса узлов inventory-контроллером.
    properties:
      resyncPeriod:
        description: |
          Интервал принудительной синхронизации при отсутствии событий. Формат — `30s`, `1m`,
          `5m` и т. п. (Go duration). Значение по умолчанию — `30s`.
