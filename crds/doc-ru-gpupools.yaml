spec:
  versions:
    - name: v1alpha1
      schema:
        openAPIV3Schema:
          description: >
            Namespaced-ресурс, описывающий логический пул GPU (полная спека: селекторы,
            нарезка, taints). Работает только в своём namespace.
          properties:
            spec:
              description: Желаемая конфигурация пула.
              properties:
                provider:
                  description: GPU-вендор (сейчас поддерживается только `Nvidia`).
                  enum:
                    - Nvidia
                  default: Nvidia
                backend:
                  description: Интеграционный бэкенд (`DevicePlugin` или `DRA`).
                  enum:
                    - DevicePlugin
                    - DRA
                  default: DevicePlugin
                resource:
                  description: Единица ресурса и параметры нарезки (имя ресурса `gpu.deckhouse.io/<имя пула>`). Поле неизменяемо после создания.
                  properties:
                    unit:
                      description: Единица («Card» или «MIG»).
                    migProfile:
                      description: MIG-профиль, когда unit=MIG.
                    migLayout:
                      description: Настройка MIG-профилей по устройствам (опционально).
                    slicesPerUnit:
                      description: Тайм-шеринговые слои на одну карту/партицию (1 — эксклюзив).
                    timeSlicingResources:
                      description: Переопределения slicesPerUnit для отдельных ресурсов (опционально).
                    maxDevicesPerNode:
                      description: Лимит устройств, который может предоставить один узел.
                nodeSelector:
                  description: Ограничение узлов, которые могут предоставлять карты в пул (immutable).
                deviceSelector:
                  description: Фильтр устройств, разрешённых к использованию в пуле (immutable).
                deviceAssignment:
                  description: Правила автоматического или ручного утверждения устройств.
                  properties:
                    requireAnnotation:
                      description: Требуется ли ручная аннотация для выдачи устройства.
                    autoApproveSelector:
                      description: Селектор устройств, которые разрешено утверждать автоматически.
                scheduling:
                  description: Подсказки для планировщика (стратегия, топология, тейнты). Поле неизменяемо.
                  properties:
                    taintsEnabled:
                      description: Включает применение taint/толераций для узлов пула (по умолчанию true).
                    strategy:
                      description: Стратегия распределения по узлам (BinPack или Spread).
                    topologyKey:
                      description: Ключ топологии для режима Spread.
                    taints:
                      description: Тейнты, которые нужно добавлять узлам, задействованным пулом.
            status:
              description: Сводная информация об использовании пула и его состоянии.
              properties:
                capacity:
                  description: Текущая ёмкость пула (всего/использовано/доступно).
                  properties:
                    total:
                      description: Общая ёмкость пула в единицах ресурса.
                    used:
                      description: Текущая занятая ёмкость.
                    available:
                      description: Доступная ёмкость (total-used).
                    unit:
                      description: Единица ресурса (`Card` или `MIG`).
                    baseUnits:
                      description: Число базовых устройств/партиций, участвующих в пуле.
                    slicesPerUnit:
                      description: Сколько слоёв (slices) даёт один base unit.
                conditions:
                  description: Список агрегированных условий готовности пула.
